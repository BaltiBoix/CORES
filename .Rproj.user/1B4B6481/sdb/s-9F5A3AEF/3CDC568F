{
    "contents" : "require(xlsx, quietly = TRUE)\nrequire(dplyr, quietly = TRUE)\nrequire(ggplot2, quietly = TRUE)\nrequire(stringr, quietly = TRUE)\nrequire(tidyr, quietly = TRUE)\nrequire(TTR, quietly = TRUE)\nif(!exists(\"plotCCAA\")) source('plotCCAA.R', encoding=\"UTF-8\")\nif(!exists(\"plotComb\")) source('plotCombustible.R', encoding=\"UTF-8\")\n\ndownload.file(\"http://www.cores.es/sites/default/files/archivos/estadisticas/consumos-pp-ccaa-provincias.xlsx\", \n              \"consumos.xlsx\", mode = \"wb\")\ndf<-read.xlsx2(\"consumos.xlsx\", sheetName=\"Consumos\", startRow = 6, header = TRUE)\ndf<-filter(df, Año != \"\")\n\ndf1<-mutate(df, Date = as.Date(paste(Año, Mes, \"1\"), \"%Y %B %d\"))\nfor(i in 5:11)  {\n      df1[,i]<-round(as.numeric(as.character(df1[,i])),0)\n}\ndf1[,5:11][is.na(df1[,5:11])]<-0\nnames(df1)<- str_replace_all(names(df1), \"[^[:alnum:]]\", \"\")\ndf1<-df1[, c(12, 1:11)]\nlevels(df1$CCAA) <- gsub(\"Total Nacional\", \"España\", levels(df1$CCAA))\ndf1<-mutate(df1, Gasolina = Gasolina97IO + Gasolina95IO + Gasolina98IO)\ndf1<-mutate(df1, Gasóleo = GasóleoA + GasóleoB + GasóleoC)\n\ndf1ma<-df1\ndf1ma<-mutate(df1ma, ind=paste0(CCAA, Provincia))\nlista<-distinct(select(df1ma, ind))\nfor(j in 1:nrow(lista)){\n      for(i in 6:14)  {\n            df1ma[df1ma$ind==lista$ind[j],i]<-round(SMA(df1ma[df1ma$ind==lista$ind[j],i], n=12),0)\n      }\n}\ndf1ma<-select(df1ma, -ind)\n\npdf(\"CORES.pdf\")\n      \nplotCCAA(\"España\", c(\"2000-01-01\", \"end\"))\n\nplotCCAA(\"Cataluña\", c(\"2000-01-01\", \"end\"))\n\nplotComb(\"Gasóleo\", c(\"2000-01-01\", \"end\"))\n\nplotComb(\"Gasolina\", c(\"2000-01-01\", \"end\"))\n\ndev.off()",
    "created" : 1445678172843.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "127387343",
    "id" : "3CDC568F",
    "lastKnownWriteTime" : 1446148959,
    "path" : "~/CORES/cores.R",
    "project_path" : "cores.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}